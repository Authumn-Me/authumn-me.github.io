<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="dark">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>AS-REP Roasting: Exploiting Kerberos Pre-Authentication Misconfigurations | Authumn’s Notebook</title>
<meta name="keywords" content="windows, security, active directory, kerberos">
<meta name="description" content="Kerberos is the primary authentication protocol used in Active Directory environments. It provides secure, ticket-based authentication and is designed to prevent credential exposure over the network. Like many security mechanisms, its effectiveness depends heavily on correct configuration. One of the most well-known Kerberos-related attack techniques that abuses misconfiguration rather than protocol flaws is AS-REP Roasting.
AS-REP Roasting is often discussed alongside Kerberoasting. While Kerberoasting targets service accounts with Service Principal Names, AS-REP Roasting focuses on user accounts that have Kerberos pre-authentication disabled. This single configuration choice can expose password-derived data that allows offline password attacks without interacting further with the domain.">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/blog/as-rep-roasting-exploiting-kerberos-pre-authentication-misconfigurations/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.12fe53f86c18b8f1b9022f785825d05a87575f72f414075af531dd655a9bba67.css" integrity="sha256-Ev5T&#43;GwYuPG5Ai94WCXQWodXX3L0FAda9THdZVqbumc=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/blog/as-rep-roasting-exploiting-kerberos-pre-authentication-misconfigurations/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.querySelector("html").dataset.theme = 'light';
    }

</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Authumn’s Notebook (Alt + H)">
                <img src="http://localhost:1313/images/logo.png" alt="" aria-label="logo"
                    height="152">Authumn’s Notebook</a>
            <div class="logo-switches">
                <button id="theme-toggle" hidden=true accesskey="t" title="(Alt + T)" aria-label="Toggle theme" >
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/" title="whoami">
                    <span>whoami</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/blog" title="Blogs">
                    <span>Blogs</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      AS-REP Roasting: Exploiting Kerberos Pre-Authentication Misconfigurations
    </h1>
    <div class="post-meta"><span title='2025-12-30 00:00:00 +0000 UTC'>December 30, 2025</span>&nbsp;·&nbsp;<span>7 min</span>

</div>
  </header> 
  <div class="post-content"><p>Kerberos is the primary authentication protocol used in Active Directory environments. It provides secure, ticket-based authentication and is designed to prevent credential exposure over the network. Like many security mechanisms, its effectiveness depends heavily on correct configuration. One of the most well-known Kerberos-related attack techniques that abuses misconfiguration rather than protocol flaws is AS-REP Roasting.</p>
<p>AS-REP Roasting is often discussed alongside Kerberoasting. While Kerberoasting targets service accounts with Service Principal Names, AS-REP Roasting focuses on user accounts that have Kerberos pre-authentication disabled. This single configuration choice can expose password-derived data that allows offline password attacks without interacting further with the domain.</p>
<h2 id="kerberos-authentication-in-brief">Kerberos authentication in brief<a hidden class="anchor" aria-hidden="true" href="#kerberos-authentication-in-brief">#</a></h2>
<p>Kerberos is the default authentication protocol used within Active Directory environments. It is designed to provide secure authentication without transmitting passwords over the network. Instead of sharing credentials directly, Kerberos relies on encrypted tickets that prove a user’s identity to services within the domain.</p>
<p>The authentication process begins when a user attempts to log on or access a resource. The client contacts the domain controller, which acts as the Key Distribution Center, to request a Ticket Granting Ticket. Under normal circumstances, Kerberos pre-authentication is required at this stage. Pre-authentication forces the client to demonstrate knowledge of the user’s password before the domain controller issues any authentication material. This step prevents unauthenticated systems from requesting meaningful Kerberos responses.</p>
<p>Once pre-authentication succeeds, the domain controller issues a Ticket Granting Ticket that can later be used to request service tickets for specific resources. These tickets are time-limited and encrypted, ensuring that only the intended parties can use them. Throughout this process, the user’s password itself is never sent across the network.</p>
<p>Kerberos pre-authentication is therefore a critical control within the protocol. It ensures that the domain controller only responds with sensitive authentication data after the client has proven possession of valid credentials. When this protection is disabled on a user account, the domain controller will issue an authentication response without first validating the password, creating the condition that enables AS-REP Roasting.</p>
<h2 id="how-as-rep-roasting-works">How AS-REP Roasting works<a hidden class="anchor" aria-hidden="true" href="#how-as-rep-roasting-works">#</a></h2>
<p>AS-REP Roasting abuses a specific Kerberos configuration where pre-authentication is disabled on a user account. Under normal circumstances, Kerberos requires the client to prove knowledge of the user’s password before the domain controller responds with authentication material.</p>
<p>When pre-authentication is disabled, the authentication flow changes. The domain controller returns an Authentication Server response, commonly referred to as an AS-REP, that contains encrypted data derived directly from the user’s password. This response does not expose the password in plaintext, but it includes cryptographic material that can be analysed offline.</p>
<p>Because this AS-REP can be obtained without successfully authenticating, it becomes possible to retrieve password-derived data without triggering account lockouts or authentication failures. The subsequent analysis takes place entirely outside the Active Directory environment, meaning domain-based protections such as rate limiting and lockout policies do not apply.</p>
<p>AS-REP Roasting can be performed without prior access to the domain if valid usernames can be identified. When authentication is already available, directory information can be queried to identify accounts with pre-authentication disabled. In both cases, the underlying issue remains the same: the domain controller provides password-derived authentication data without verifying the requester’s identity.</p>
<p>This technique does not exploit a vulnerability in Kerberos itself. It relies on a legitimate but risky configuration option combined with weak or predictable passwords. When these conditions align, affected user accounts become offline password exposure points that are difficult to detect through standard monitoring.</p>
<h2 id="observed-behaviour-during-analysis">Observed behaviour during analysis<a hidden class="anchor" aria-hidden="true" href="#observed-behaviour-during-analysis">#</a></h2>
<p>In the evidence below, I queried user accounts to determine whether Kerberos pre-authentication was disabled. For vulnerable accounts, the domain controller returned an AS-REP containing encrypted data tied to the user’s password.</p>
<p><img alt="Captured AS-REP hash using GetNPUsers" loading="lazy" src="/blog/as-rep-roasting-exploiting-kerberos-pre-authentication-misconfigurations/GetNPUsersHashCapture.png">
<em>This screenshot shows an Authentication Server response returned for a user account with Kerberos pre-authentication disabled. The encrypted data can be extracted for offline analysis.</em></p>
<p>To complete the overview, the following screenshot shows how this configuration appears in the graphical interface of Active Directory Users and Computers, where the pre-authentication setting can be enabled or disabled on a per-user basis.</p>
<p><img alt="User account configuration with pre-authentication disabled" loading="lazy" src="/blog/as-rep-roasting-exploiting-kerberos-pre-authentication-misconfigurations/preauth.png"></p>
<p>The returned data does not expose plaintext credentials, but it contains cryptographic material that can be processed offline. No interaction with the target user or modification of directory objects was required.</p>
<h2 id="impact-of-extracted-as-rep-hashes">Impact of extracted AS-REP hashes<a hidden class="anchor" aria-hidden="true" href="#impact-of-extracted-as-rep-hashes">#</a></h2>
<p>Once an AS-REP has been obtained, it can be analysed offline. The success of recovering the original password depends on password complexity and reuse. In the case below, the results show that the hash stored in the file ASREProastables.txt was successfully cracked using Hashcat. The recovered plaintext password for the account brandon.stark is iseedeadpeople, as demonstrated in the screenshot.</p>
<p><img alt="Offline password recovery of an AS-REP hash" loading="lazy" src="/blog/as-rep-roasting-exploiting-kerberos-pre-authentication-misconfigurations/CrackingHashWithHashcat.png">
<em>This screenshot demonstrates that a weak user password can be recovered after extracting the AS-REP response.</em></p>
<p>A compromised user account can have a wide range of impact depending on its privileges. Even low-privileged accounts can provide valuable access for further enumeration or serve as a starting point for additional attack paths within the domain.</p>
<h2 id="authenticated-versus-unauthenticated-attack-paths">Authenticated versus unauthenticated attack paths<a hidden class="anchor" aria-hidden="true" href="#authenticated-versus-unauthenticated-attack-paths">#</a></h2>
<p>AS-REP Roasting can be performed from both authenticated and unauthenticated contexts, depending on the level of access available within the domain.</p>
<p>When authentication is already available, directory queries can be used to enumerate user accounts and retrieve additional user attributes. This makes it possible to identify accounts that have Kerberos pre-authentication disabled and selectively request AS-REP responses for those users.</p>
<p>Query vulnerable accounts via PowerShell:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span>Import-Module ActiveDirectory
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$DONT_REQ_PREAUTH = 0x00400000
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Get-ADUser -Filter * -Properties userAccountControl |
</span></span><span style="display:flex;"><span>  Where-Object { $_.userAccountControl <span style="color:#f92672">-band</span> $DONT_REQ_PREAUTH } |
</span></span><span style="display:flex;"><span>  Select-Object sAMAccountName,
</span></span><span style="display:flex;"><span>    @{ Name=<span style="color:#e6db74">&#39;PreAuthEnabled&#39;</span>; Expression={ $true } }
</span></span></code></pre></div><p><img alt="Enumerating vulnerable users via directory queries" loading="lazy" src="/blog/as-rep-roasting-exploiting-kerberos-pre-authentication-misconfigurations/ResultScriptPreAuth.png"></p>
<p>In scenarios where no initial access to the domain exists, AS-REP Roasting can still be performed in an unauthenticated manner. This approach relies on discovering valid usernames and requesting AS-REP responses for those accounts. Tools such as kerbrute can be used to identify accounts.</p>
<p>Username discovery often relies on common naming conventions and statistically likely username formats. Publicly available wordlists can assist in this process, such as those found in the following repository: <a href="https://github.com/insidetrust/statistically-likely-usernames">https://github.com/insidetrust/statistically-likely-usernames</a></p>
<p><img alt="Unauthenticated AS-REP Roasting using kerbrute" loading="lazy" src="/blog/as-rep-roasting-exploiting-kerberos-pre-authentication-misconfigurations/Unauthenticated%20AS-REP%20Roasting.png"></p>
<p>Both authenticated and unauthenticated approaches exploit the same underlying issue. Once an AS-REP has been obtained, the offline analysis process is identical.</p>
<h2 id="the-root-cause-misconfigured-user-accounts">The root cause: misconfigured user accounts<a hidden class="anchor" aria-hidden="true" href="#the-root-cause-misconfigured-user-accounts">#</a></h2>
<p>AS-REP Roasting is only possible when a user account is explicitly configured to not require Kerberos pre-authentication. This setting is rarely needed in modern environments and is often the result of legacy requirements or misconfiguration.</p>
<p><img alt="User account configuration with pre-authentication disabled" loading="lazy" src="/blog/as-rep-roasting-exploiting-kerberos-pre-authentication-misconfigurations/pre-authentication-disabled.png"></p>
<p>This single configuration choice transforms a standard user account into an offline password exposure point.</p>
<h2 id="why-as-rep-roasting-is-difficult-to-detect">Why AS-REP Roasting is difficult to detect<a hidden class="anchor" aria-hidden="true" href="#why-as-rep-roasting-is-difficult-to-detect">#</a></h2>
<p>AS-REP Roasting blends into normal Kerberos behaviour. Authentication requests appear valid and do not generate errors or alerts by default. The offline password analysis phase happens entirely outside the domain and leaves no trace in security logs.</p>
<p>Several factors contribute to this:</p>
<ul>
<li>No authentication is required for vulnerable accounts</li>
<li>No interaction with the user is needed</li>
<li>Offline analysis bypasses account protections</li>
<li>Weak passwords remain the primary risk factor</li>
</ul>
<p>As a result, AS-REP Roasting often goes unnoticed until compromised credentials are reused elsewhere.</p>
<h2 id="mitigation-strategies"><strong>Mitigation strategies</strong><a hidden class="anchor" aria-hidden="true" href="#mitigation-strategies">#</a></h2>
<p>Reducing the risk of AS-REP Roasting primarily requires attention to account configuration and password hygiene rather than changes to the Kerberos protocol itself.</p>
<h3 id="enforce-kerberos-pre-authentication"><strong>Enforce Kerberos pre-authentication</strong><a hidden class="anchor" aria-hidden="true" href="#enforce-kerberos-pre-authentication">#</a></h3>
<p>Kerberos pre-authentication should be enabled for all user accounts unless there is a clear and well-documented reason to disable it. In modern Active Directory environments, there are very few legitimate use cases for turning this setting off. Enforcing pre-authentication ensures that the domain controller does not return password-derived authentication data to unauthenticated requests.</p>
<h3 id="review-and-audit-user-account-settings-regularly"><strong>Review and audit user account settings regularly</strong><a hidden class="anchor" aria-hidden="true" href="#review-and-audit-user-account-settings-regularly">#</a></h3>
<p>User accounts should be reviewed on a regular basis to identify exceptions where pre-authentication has been disabled. These exceptions are often introduced for legacy reasons and remain in place long after they are no longer required. Periodic audits help ensure that misconfigurations are detected and corrected in a timely manner.</p>
<h3 id="use-strong-and-unique-passwords"><strong>Use strong and unique passwords</strong><a hidden class="anchor" aria-hidden="true" href="#use-strong-and-unique-passwords">#</a></h3>
<p>Strong password policies remain an essential control. Since AS-REP Roasting enables offline password attacks, weak or reused passwords significantly increase the risk of compromise. Ensuring sufficient password length and complexity reduces the feasibility of recovering credentials from extracted AS-REP responses.</p>
<h3 id="monitor-for-unusual-authentication-behaviour"><strong>Monitor for unusual authentication behaviour</strong><a hidden class="anchor" aria-hidden="true" href="#monitor-for-unusual-authentication-behaviour">#</a></h3>
<p>Although AS-REP Roasting is difficult to detect, abnormal authentication patterns such as repeated AS-REQ attempts against multiple user accounts may indicate probing activity. Monitoring Kerberos-related events and correlating them with other network signals can help identify suspicious behaviour.</p>
<h2 id="conclusion">Conclusion<a hidden class="anchor" aria-hidden="true" href="#conclusion">#</a></h2>
<p>AS-REP Roasting demonstrates how a small configuration choice can introduce a significant security risk in Active Directory environments. The attack does not exploit a weakness in Kerberos itself, but rather abuses the absence of pre-authentication on user accounts.</p>
<p>This article does not suggest that Kerberos should be avoided or modified. Instead, it highlights how misconfigured accounts can expose password-derived data that enables offline attacks. By ensuring pre-authentication is enabled, enforcing strong password policies and regularly auditing account settings, organisations can effectively eliminate this class of attack and reduce their exposure to credential compromise.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/windows/">Windows</a></li>
      <li><a href="http://localhost:1313/tags/security/">Security</a></li>
      <li><a href="http://localhost:1313/tags/active-directory/">Active-Directory</a></li>
      <li><a href="http://localhost:1313/tags/kerberos/">Kerberos</a></li>
    </ul>
<nav class="paginav">
  <a class="next" href="http://localhost:1313/blog/kerberoasting-how-service-accounts-become-a-silent-credential-exposure-risk/">
    <span class="title">Next »</span>
    <br>
    <span>Kerberoasting: How Service Accounts Become a Silent Credential Exposure Risk</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2026 <a href="http://localhost:1313/">Authumn’s Notebook</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a><script src="https://unpkg.com/medium-zoom@1.0.8/dist/medium-zoom.min.js"></script>
<script>
  mediumZoom('.post-content img', {
    margin: 24,
    background: '#000'
  })
</script>


<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
