<!doctype html><html lang=en dir=auto data-theme=dark><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>RDP Bitmap Cache: verborgen sporen van Remote Desktop sessies | Authumns blog</title><meta name=keywords content="rdp,forensics,windows,security"><meta name=description content="RDP Bitmap Cache: verborgen sporen van Remote Desktop sessies
Remote Desktop has been a standard tool for system administrators and anyone who needs to manage a server or workstation from a distance for many years. During a session far more happens behind the scenes than most people realise. Windows quietly stores small fragments of the remote screen, a mechanism known as the RDP Bitmap Cache.
Many users assume that once an RDP session is closed, anything that appeared on the screen disappears as well. In reality a portion of that visual data remains on the local machine. Forensic investigators consider this a valuable source of information, and in security-focused environments it is important to understand what this cache contains, how it works and which risks it introduces."><meta name=author content><link rel=canonical href=https://authumn-me.github.io/posts/rdp-big-brother-is-watching-you/><link crossorigin=anonymous href=/assets/css/stylesheet.fd5566c526ae48aadabd950798a2dc3568536401560eae5caac3765a42a9e7b5.css integrity="sha256-/VVmxSauSKravZUHmKLcNWhTZAFWDq5cqsN2WkKp57U=" rel="preload stylesheet" as=style><link rel=icon href=https://authumn-me.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://authumn-me.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://authumn-me.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://authumn-me.github.io/apple-touch-icon.png><link rel=mask-icon href=https://authumn-me.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://authumn-me.github.io/posts/rdp-big-brother-is-watching-you/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script>localStorage.getItem("pref-theme")==="light"&&(document.querySelector("html").dataset.theme="light")</script><meta property="og:url" content="https://authumn-me.github.io/posts/rdp-big-brother-is-watching-you/"><meta property="og:site_name" content="Authumns blog"><meta property="og:title" content="RDP Bitmap Cache: verborgen sporen van Remote Desktop sessies"><meta property="og:description" content="RDP Bitmap Cache: verborgen sporen van Remote Desktop sessies Remote Desktop has been a standard tool for system administrators and anyone who needs to manage a server or workstation from a distance for many years. During a session far more happens behind the scenes than most people realise. Windows quietly stores small fragments of the remote screen, a mechanism known as the RDP Bitmap Cache.
Many users assume that once an RDP session is closed, anything that appeared on the screen disappears as well. In reality a portion of that visual data remains on the local machine. Forensic investigators consider this a valuable source of information, and in security-focused environments it is important to understand what this cache contains, how it works and which risks it introduces."><meta property="og:locale" content="nl-be"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-01-01T00:00:00+00:00"><meta property="article:modified_time" content="2025-01-01T00:00:00+00:00"><meta property="article:tag" content="Rdp"><meta property="article:tag" content="Forensics"><meta property="article:tag" content="Windows"><meta property="article:tag" content="Security"><meta name=twitter:card content="summary"><meta name=twitter:title content="RDP Bitmap Cache: verborgen sporen van Remote Desktop sessies"><meta name=twitter:description content="RDP Bitmap Cache: verborgen sporen van Remote Desktop sessies
Remote Desktop has been a standard tool for system administrators and anyone who needs to manage a server or workstation from a distance for many years. During a session far more happens behind the scenes than most people realise. Windows quietly stores small fragments of the remote screen, a mechanism known as the RDP Bitmap Cache.
Many users assume that once an RDP session is closed, anything that appeared on the screen disappears as well. In reality a portion of that visual data remains on the local machine. Forensic investigators consider this a valuable source of information, and in security-focused environments it is important to understand what this cache contains, how it works and which risks it introduces."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://authumn-me.github.io/posts/"},{"@type":"ListItem","position":2,"name":"RDP Bitmap Cache: verborgen sporen van Remote Desktop sessies","item":"https://authumn-me.github.io/posts/rdp-big-brother-is-watching-you/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"RDP Bitmap Cache: verborgen sporen van Remote Desktop sessies","name":"RDP Bitmap Cache: verborgen sporen van Remote Desktop sessies","description":"RDP Bitmap Cache: verborgen sporen van Remote Desktop sessies Remote Desktop has been a standard tool for system administrators and anyone who needs to manage a server or workstation from a distance for many years. During a session far more happens behind the scenes than most people realise. Windows quietly stores small fragments of the remote screen, a mechanism known as the RDP Bitmap Cache.\nMany users assume that once an RDP session is closed, anything that appeared on the screen disappears as well. In reality a portion of that visual data remains on the local machine. Forensic investigators consider this a valuable source of information, and in security-focused environments it is important to understand what this cache contains, how it works and which risks it introduces.\n","keywords":["rdp","forensics","windows","security"],"articleBody":"RDP Bitmap Cache: verborgen sporen van Remote Desktop sessies Remote Desktop has been a standard tool for system administrators and anyone who needs to manage a server or workstation from a distance for many years. During a session far more happens behind the scenes than most people realise. Windows quietly stores small fragments of the remote screen, a mechanism known as the RDP Bitmap Cache.\nMany users assume that once an RDP session is closed, anything that appeared on the screen disappears as well. In reality a portion of that visual data remains on the local machine. Forensic investigators consider this a valuable source of information, and in security-focused environments it is important to understand what this cache contains, how it works and which risks it introduces.\nThis technique has been known in the security community for a long time. The process can be reproduced with publicly available tools, which demonstrates how much information can be recovered long after the remote session has ended.\nBackground What is the RDP Bitmap Cache During an RDP connection Windows divides the remote screen into many small square tiles. These tiles are then saved locally so that identical content can be shown again without being retransmitted. This increases performance and reduces bandwidth usage.\nThe optimisation comes with a side effect. The local system accumulates a collection of image fragments that represent parts of the remote session. These files are stored inside the user profile in the following folder:\n%LocalAppData%\\Microsoft\\Terminal Server Client\\Cache This folder contains .bmc files and .bin files, each holding different segments of the cached screen tiles. The screenshot below illustrates this directory with both file types present.\nExploiting this ‘feature’ Converting the cache files into readable images The ANSSI BMC Tools project on GitHub provides functionality to parse .bmc and .bin files and convert the contained tiles into ordinary image files. After conversion the output directory contains a large number of tiny screenshots that represent fragments of the original session.\nThe screenshot below shows this process in action. Several of the exported tiles clearly reveal elements of websites that were open during the session, including microsoft.com and resilix.be. Even at a very small size the colours, layout and branding of these sites remain recognisable.\nWhat appeared when reconstructing the tiles During the analysed session the remote desktop displayed browser windows containing the Microsoft and Resilix websites. A Notepad window with sample login information was also visible. A screenshot of the active RDP session was taken beforehand to show the original context.\nOnce the cache files were exported and viewed as tiles, multiple fragments were found that contained parts of the Notepad window. Several of these tiles included enough readable characters to reconstruct the redacted login text. A composite image was created to demonstrate how easily the information could be pieced together.\nThe following screenshots displays the output folder in File Explorer. When examining the exported tiles closely, many fragments reveal identifiable portions of the visited websites. Combined, these tiles form a surprisingly complete representation of activity within the remote session.\nImpact Why this matters for anyone who uses RDP Nothing unusual is required for this data to appear. No malware, no exploit and no form of manipulation is involved. This is standard RDP behaviour that has existed for years. The cache was designed to improve performance, not to protect privacy or confidentiality. It quietly stores fragments of whatever happened to be shown on the screen.\nIf someone gains access to a laptop or user profile, they can extract and analyse the cache in the same way I did. The fact that open source tools make this process straightforward should make any organisation think carefully about how RDP is used and how local caching is managed.\nA small feature with unexpected consequences This behaviour has been described by researchers for years. Reproducing it with modern tools shows how much information may remain available long after the remote session has ended. Understanding the nature of the stored data is essential for preventing unintended information exposure and for making informed decisions about the use of RDP in sensitive environments.\nMitigation Mitigation options for controlling RDP bitmap caching Although the RDP Bitmap Cache is a long standing performance feature, the associated data retention can be reduced or eliminated through several configuration changes.\nOne commonly used method is disabling persistent bitmap caching in the Remote Desktop client settings. The screenshot below illustrates this option in the Experience tab of the standard mstsc interface. Clearing this checkbox prevents the client from storing tile data on the local system during future RDP sessions.\nThis approach limits the creation of new cache files, although any previously stored tiles remain until manually removed. It is a straightforward remediation step and can be applied on individual systems without additional infrastructure.\nIn environments that rely on centralised management, the same restriction can be enforced through Group Policy. Active Directory allows administrators to disable persistent bitmap caching for all domain joined machines by enabling the corresponding policy under the Remote Desktop Session Host configuration. This ensures consistent behaviour across the organisation and prevents local overrides.\nConclusion The RDP Bitmap Cache may seem like a minor technical detail, but in reality it can introduce significant and often overlooked security risks. Because Windows stores small fragments of the remote screen for performance reasons, sensitive visual information can remain accessible long after an RDP session has ended. As demonstrated above, even ordinary administrative sessions can leave behind enough data to reconstruct visited websites, documents, or even parts of login information.\nFor any organisation relying on RDP, it is essential to understand how this caching mechanism works, what data is retained, and which configuration options are available to reduce exposure. By disabling persistent caching, enforcing group policies, and reviewing how remote access is handled across the environment, you can drastically minimise the chance of unintended information leakage.\n","wordCount":"979","inLanguage":"en","datePublished":"2025-01-01T00:00:00Z","dateModified":"2025-01-01T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://authumn-me.github.io/posts/rdp-big-brother-is-watching-you/"},"publisher":{"@type":"Organization","name":"Authumns blog","logo":{"@type":"ImageObject","url":"https://authumn-me.github.io/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://authumn-me.github.io/ accesskey=h title="Authumns blog (Alt + H)">Authumns blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://authumn-me.github.io/ title=Blog><span>Blog</span></a></li><li><a href=https://authumn-me.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://authumn-me.github.io/archives/ title=Archief><span>Archief</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">RDP Bitmap Cache: verborgen sporen van Remote Desktop sessies</h1><div class=post-meta><span title='2025-01-01 00:00:00 +0000 UTC'>January 1, 2025</span>&nbsp;·&nbsp;<span>5 min</span></div></header><div class=post-content><h1 id=rdp-bitmap-cache-verborgen-sporen-van-remote-desktop-sessies>RDP Bitmap Cache: verborgen sporen van Remote Desktop sessies<a hidden class=anchor aria-hidden=true href=#rdp-bitmap-cache-verborgen-sporen-van-remote-desktop-sessies>#</a></h1><p>Remote Desktop has been a standard tool for system administrators and anyone who needs to manage a server or workstation from a distance for many years. During a session far more happens behind the scenes than most people realise. Windows quietly stores small fragments of the remote screen, a mechanism known as the RDP Bitmap Cache.</p><p>Many users assume that once an RDP session is closed, anything that appeared on the screen disappears as well. In reality a portion of that visual data remains on the local machine. Forensic investigators consider this a valuable source of information, and in security-focused environments it is important to understand what this cache contains, how it works and which risks it introduces.</p><p>This technique has been known in the security community for a long time. The process can be reproduced with publicly available tools, which demonstrates how much information can be recovered long after the remote session has ended.</p><h2 id=background>Background<a hidden class=anchor aria-hidden=true href=#background>#</a></h2><h3 id=what-is-the-rdp-bitmap-cache>What is the RDP Bitmap Cache<a hidden class=anchor aria-hidden=true href=#what-is-the-rdp-bitmap-cache>#</a></h3><p>During an RDP connection Windows divides the remote screen into many small square tiles. These tiles are then saved locally so that identical content can be shown again without being retransmitted. This increases performance and reduces bandwidth usage.</p><p>The optimisation comes with a side effect. The local system accumulates a collection of image fragments that represent parts of the remote session. These files are stored inside the user profile in the following folder:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span> %LocalAppData%\Microsoft\Terminal Server Client\Cache
</span></span></code></pre></div><p>This folder contains .bmc files and .bin files, each holding different segments of the cached screen tiles. The screenshot below illustrates this directory with both file types present.</p><p><img alt="Directory Illustration" loading=lazy src=/posts/rdp-big-brother-is-watching-you/DirectoryIllustration.png></p><h2 id=exploiting-this-feature>Exploiting this &lsquo;feature&rsquo;<a hidden class=anchor aria-hidden=true href=#exploiting-this-feature>#</a></h2><h3 id=converting-the-cache-files-into-readable-images>Converting the cache files into readable images<a hidden class=anchor aria-hidden=true href=#converting-the-cache-files-into-readable-images>#</a></h3><p>The ANSSI BMC Tools project on GitHub provides functionality to parse .bmc and .bin files and convert the contained tiles into ordinary image files. After conversion the output directory contains a large number of tiny screenshots that represent fragments of the original session.</p><p>The screenshot below shows this process in action. Several of the exported tiles clearly reveal elements of websites that were open during the session, including microsoft.com and resilix.be. Even at a very small size the colours, layout and branding of these sites remain recognisable.</p><p><img alt=&ldquo;Usage-bmc-tool.py&rdquo; loading=lazy src=/posts/rdp-big-brother-is-watching-you/Usage-bmc-tool.png></p><h3 id=what-appeared-when-reconstructing-the-tiles>What appeared when reconstructing the tiles<a hidden class=anchor aria-hidden=true href=#what-appeared-when-reconstructing-the-tiles>#</a></h3><p>During the analysed session the remote desktop displayed browser windows containing the Microsoft and Resilix websites. A Notepad window with sample login information was also visible. A screenshot of the active RDP session was taken beforehand to show the original context.</p><p><img alt="active-RDP-session showcase" loading=lazy src=/posts/rdp-big-brother-is-watching-you/active-RDP-session.png></p><p>Once the cache files were exported and viewed as tiles, multiple fragments were found that contained parts of the Notepad window. Several of these tiles included enough readable characters to reconstruct the redacted login text. A composite image was created to demonstrate how easily the information could be pieced together.</p><p><img alt="Composited image" loading=lazy src=/posts/rdp-big-brother-is-watching-you/Composited-Image.png></p><p>The following screenshots displays the output folder in File Explorer. When examining the exported tiles closely, many fragments reveal identifiable portions of the visited websites. Combined, these tiles form a surprisingly complete representation of activity within the remote session.</p><p><img alt="Result 1" loading=lazy src=/posts/rdp-big-brother-is-watching-you/Result-1.png>
<img alt="Result 2" loading=lazy src=/posts/rdp-big-brother-is-watching-you/Result-2.png></p><h2 id=impact>Impact<a hidden class=anchor aria-hidden=true href=#impact>#</a></h2><h3 id=why-this-matters-for-anyone-who-uses-rdp>Why this matters for anyone who uses RDP<a hidden class=anchor aria-hidden=true href=#why-this-matters-for-anyone-who-uses-rdp>#</a></h3><p>Nothing unusual is required for this data to appear. No malware, no exploit and no form of manipulation is involved. This is standard RDP behaviour that has existed for years. The cache was designed to improve performance, not to protect privacy or confidentiality. It quietly stores fragments of whatever happened to be shown on the screen.</p><p>If someone gains access to a laptop or user profile, they can extract and analyse the cache in the same way I did. The fact that open source tools make this process straightforward should make any organisation think carefully about how RDP is used and how local caching is managed.</p><h3 id=a-small-feature-with-unexpected-consequences>A small feature with unexpected consequences<a hidden class=anchor aria-hidden=true href=#a-small-feature-with-unexpected-consequences>#</a></h3><p>This behaviour has been described by researchers for years. Reproducing it with modern tools shows how much information may remain available long after the remote session has ended. Understanding the nature of the stored data is essential for preventing unintended information exposure and for making informed decisions about the use of RDP in sensitive environments.</p><h2 id=mitigation>Mitigation<a hidden class=anchor aria-hidden=true href=#mitigation>#</a></h2><h3 id=mitigation-options-for-controlling-rdp-bitmap-caching>Mitigation options for controlling RDP bitmap caching<a hidden class=anchor aria-hidden=true href=#mitigation-options-for-controlling-rdp-bitmap-caching>#</a></h3><p>Although the RDP Bitmap Cache is a long standing performance feature, the associated data retention can be reduced or eliminated through several configuration changes.</p><p>One commonly used method is disabling persistent bitmap caching in the Remote Desktop client settings. The screenshot below illustrates this option in the Experience tab of the standard mstsc interface. Clearing this checkbox prevents the client from storing tile data on the local system during future RDP sessions.</p><p><img alt=Mitigation loading=lazy src=/posts/rdp-big-brother-is-watching-you/Mitigation.png></p><p>This approach limits the creation of new cache files, although any previously stored tiles remain until manually removed. It is a straightforward remediation step and can be applied on individual systems without additional infrastructure.</p><p>In environments that rely on centralised management, the same restriction can be enforced through Group Policy. Active Directory allows administrators to disable persistent bitmap caching for all domain joined machines by enabling the corresponding policy under the Remote Desktop Session Host configuration. This ensures consistent behaviour across the organisation and prevents local overrides.</p><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>The RDP Bitmap Cache may seem like a minor technical detail, but in reality it can introduce significant and often overlooked security risks. Because Windows stores small fragments of the remote screen for performance reasons, sensitive visual information can remain accessible long after an RDP session has ended. As demonstrated above, even ordinary administrative sessions can leave behind enough data to reconstruct visited websites, documents, or even parts of login information.</p><p>For any organisation relying on RDP, it is essential to understand how this caching mechanism works, what data is retained, and which configuration options are available to reduce exposure. By disabling persistent caching, enforcing group policies, and reviewing how remote access is handled across the environment, you can drastically minimise the chance of unintended information leakage.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://authumn-me.github.io/tags/rdp/>Rdp</a></li><li><a href=https://authumn-me.github.io/tags/forensics/>Forensics</a></li><li><a href=https://authumn-me.github.io/tags/windows/>Windows</a></li><li><a href=https://authumn-me.github.io/tags/security/>Security</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://authumn-me.github.io/>Authumns blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>